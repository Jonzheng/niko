<pull-down id="scroll"
		requesting="{{requesting}}"
		end="{{end}}"
		has-top="{{hasTop}}"
		color="{{color}}"
		bind:refresh="refresh"
		bind:more="more">

  <view class="container">
    <view class="box-head">

      <view class="box-avatar">
        <image class="sk-avatar" src="https://avatar-sk-1256378396.cos.ap-nanjing.myqcloud.com/n_bah.png"></image>
      </view>
      <view class="box-profile">
        <view class="box-line">
          <view class="name">{{cname}}
            <view class="cv">cv: {{cv}}</view>
          </view>
          <button class="out-share" open-type="share" size="mini">
            <image class="btn-share" src="../../images/share.png"></image>
          </button>
        </view>
        <view class="box-line">
          <view class="curr-title" bindtap="showOther">
            <view class="text">{{skill}}</view>
            <view class='text-more {{rt90 ? "rt-other":""}}'>〉</view>
          </view>
        </view>
      </view>

      <!-- <view class='box-other {{show_other ? "other-show":""}}'>
        <block wx:for="{{other_lst}}" wx:key="mkey">
          <view class='sk-btn' data-fid='{{item.file_id}}' bindtap="reload" hover-class="space-hover">
            <view class='sk-title'>{{item.title}}</view>
            <view class='sk-serifu'>{{item.serifu}}</view>
          </view>
        </block>
      </view> -->

    </view>
  <view wx:if="{{showVideo}}" class="video-mask" catchtap="hideVideo">
      <video id="thisVideo" class="video-detail" src="{{srcVideo}}" autoplay="{{true}}" object-fit="fill"
        bindplay="videoOnPlay" catchtap="pass" show-progress="{{false}}" controls="{{true}}" 
        bindfullscreenchange="fullScreenChange">
      </video>
  </view>
    <view class="box-body">

      <view class="box-serifu">
        <view class='serifu'>
          <block wx:for="{{serifuList}}" wx:key="mkey">
            <view class="serifu-items">
              <view wx:if="{{item.desc}}" class="desc">{{item.desc}}</view>
              <view class="value">{{item.value}}</view>
            </view>
          </block>
        </view>
        <view class='text-ron'>____</view>
        <view class='text-ron'>{{koner}}</view>
        <view class='text-ron'>{{roma}}</view>

        <view class="box-ori">
          <view class="btn-circle" bindtap="playOri" hover-class="black-hover">
            <view class='{{oriPlaying ? "sound-stop" : "sound-play"}} '></view>
          </view>
          <view class="shadow-ori">
          <view class='{{slider}}'></view>
            <block wx:for="{{shadow}}" wx:key="mkey">
              <view class="ele-ori" style="height:{{item}};transition: height 0.6s ease-in;"></view>
            </block>
          </view>
        </view>

        <view class="box-line flex-right">
          <view class="out-btn" bindtap="showVideo">
            <image class="btn-video" src="../../images/video.png"></image>
          </view>
          <view class="out-btn" bindtap="nextSerifu">
            <image class="btn-next" src="../../images/next.png"></image>
          </view>
        </view>

      </view>

    <view class="re-title">录音:</view>

      <view class="record-list">
        <block wx:for="{{recordList}}" wx:key="mkey">
          <template is="ele-master" data="{{...item,index,icon_more,icon_comm,icon_zan_em,icon_zan_fu}}"/>
        </block>
      </view>

    </view>
  </view>

</pull-down>

  <view class="fixed-bottom">
    <view class="my-progress-box">
      <view class='{{progress_record == 0 ? "" : "my-progress"}} {{isRecording ? "an-totop": ""}}'
        style='width:{{isRecording ? "" : progress_record}}%;'></view>
    </view>
    <view class="record-box">
      <button hidden="{{hasLogin}}" open-type="getUserInfo" class="btn-login" bindgetuserinfo="getUserInfo"></button>
      <view class='btn-circle {{!isRecording && hasTmp ? "" : "btn-hidden"}}' bindtap="playMyVoice" hover-class="black-hover">
        <view class='{{isPlaying ? "sound-stop" : "sound-play"}} '></view>
      </view>

      <view class="btn-circle" bindtap="startRecord" hover-class="black-hover">
        <view class='{{isRecording ? "sound-stop" : "btn-empty"}}'></view>
        <image wx:if="{{hasTmp}}" src='{{icon_trash}}' class='btn-record'></image>
        <image wx:elif="{{!isRecording}}" src='{{icon_record}}' class='btn-record'></image>
      </view>

      <view class='btn-circle {{isPlayed && hasTmp ? "" : "btn-hidden"}}' bindtap="uploadRecord" hover-class="black-hover">
        <image src='{{isPlayed && hasTmp ? icon_upload : ""}}' class="btn-record"></image>
      </view>

    </view>
  </view>

<action-sheet formShow="{{otherShow}}" bind:clickMask="closeMask" boxHeight="{{isIpx ? 920 : 720}}">
  <block wx:for="{{list}}" wx:key="index">
      <view class="input-edit"
        catchtap="toSerifu" data-index="{{index}}" data-title="{{item.title}}" data-serifu="{{item.serifu}}">
        <view class="edit-label">
          <view class="title {{fileId == item.file_id ? 'cur':''}}">{{item.title}}</view>
          <view class="serifu {{fileId == item.file_id ? 'cur':''}}">{{item.serifu}}</view>
        </view>
      </view>
  </block>
</action-sheet>
<action-sheet formShow="{{commShow}}" bind:clickMask="closeMask" bind:confirmInput="confirmInput" bind:blur="clearInput"
  hasInput="{{true}}" boxHeight="{{isIpx ? 900 : 720}}" inputValue="{{inputValue}}" inputPh="{{inputPh}}" formTitle="评论">
  <view class="comm-item" wx:for="{{commentList}}" wx:key="index">
    <image class="re-avatar" mode="aspectFill" src="{{item.avatar_url}}"/>
    <view class="comm-right" catchtap="replyUser" data-cid="{{item.id}}" data-nickname="{{item.nick_name}}" data-content="{{item.content}}">
      <view class="comm-top">
        <view class="name">{{item.nick_name}}<view wx:if="{{item.isAuthor}}" class="comm-author">up</view></view>
        <view class="time">{{item.dateStr}}</view>
      </view>
      <view wx:if="{{item.re_id}}" class="comm-re">
        <text class="">{{item.re_name ? ' 回复 '+item.re_name+'：': ''}}</text>{{item.re_content || ' ** 原评论已被删除 ** '}}
      </view>

      <view class="comm-content">
        <view class="content">{{item.content}}</view>
        <view class="btn" wx:if="{{item.isOwner}}" catchtap="delCommConfirm"
          data-cid="{{item.id}}" data-rid="{{item.record_id}}" data-content="{{item.content}}">删除
        </view>
      </view>

    </view>
  </view>
  <view class="weui-footer__text" wx:if="{{comEnd && commentList.length > 0}}"> - 没有更多评论了 -</view>
</action-sheet>

<template name="ele-master">
  <view class="box-record">
    <view class="box-line">
      <view class="nickname">{{show_name ? show_name : nick_name}}</view>
      <view class="date">{{dateStr}}</view>
    </view>
    <view class="box-line">
      <image src="{{avatar_url ? avatar_url : '../../images/de-avatar.png'}}" class="re-avatar"></image>
      <view class="tri"></view>
      <view class="re-width">
        <view class="{{boxStyle}} {{anListen}}" data-idx="{{index}}"
          bindtap="listen" data-nickName="{{show_name ? show_name : nick_name}}" data-record_id="{{record_id}}">
          <view class='box-paly-btn'>
            <view hidden="{{isListen}}" class="btn-one"></view>
            <view class="btn-two {{listenStatus}}"></view>
            <view hidden="{{isListen}}" class="btn-three"></view>
          </view>
          <view class='box-record-right'>
            <block wx:for="{{isLoading}}" wx:key="mkey">
              <view class="play-foo" style="animation: scay 2s infinite {{item}}s;"></view>
            </block>
          </view>
        </view>
        <view class="{{btnDelStyle}}" bindtap='delConfirm' data-idx="{{index}}" data-record_id="{{record_id}}">删除</view>
        <view class="{{btnPoiStyle}}" data-idx="{{index}}" data-record_id="{{record_id}}" hidden="{{true}}"></view>
      </view>
      <image wx:if="{{isMine}}" src="{{icon_more}}" class="sm-icon {{btnRt}}" bindtap='showMore' data-idx="{{index}}"></image>
    </view>
    <view class="box-line flex-right">
      <view class="menu-comm" bindtap='updateHeart' data-idx="{{index}}" data-status="{{heartStatus}}">
        <view class="text-heart">{{heart}}</view>
        <image src="{{heartShape}}" class="sm-icon"></image>
      </view>
      <view class="menu-comm" bindtap='showComment' data-idx="{{index}}">
        <view class="text-heart">{{comm}}</view>
        <image src="{{icon_comm}}" class="icon-comm"></image>
      </view>
    </view>
  </view>
</template>